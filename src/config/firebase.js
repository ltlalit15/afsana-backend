import admin from 'firebase-admin';
import dotenv from 'dotenv';
dotenv.config();

// üîê Decode base64
const base64 = `ewogICJ0eXBlIjogInNlcnZpY2VfYWNjb3VudCIsCiAgInByb2plY3RfaWQiOiAic3R1ZGVudC1wb3J0YWwtZWEzYWUiLAogICJwcml2YXRlX2tleV9pZCI6ICI5ZmI0YjAyNzJhY2Y0MmY5ZDRkM2RmMjk1OGQxNTVlMGY4Njk3M2QyIiwKICAicHJpdmF0ZV9rZXkiOiAiLS0tLS1CRUdJTiBQUklWQVRFIEtFWS0tLS0tXG5NSUlFdmdJQkFEQU5CZ2txaGtpRzl3MEJBUUVGQUFTQ0JLZ3dnZ1NrQWdFQUFvSUJBUUNaOHMyOE1oUzZ5OHhRXG4rM0Y4emlIaWxJUVN6elJEYXdjcGI2MWRUbWZrY2RENVdOTkdqOG9jeU5VQS9samIzNnhtb0RtaFR0c3g5Y0l4XG4wNnNtSjZXblEzSUJsaTFkRVVOVllIR0h2V0hzSGVhdGRtL1dOdXNqTHd4bWJCT1pMZGVNb3lvQmkzV1V0eCs3XG5kVU0zZzV2Wm9sTXhYUGtpV0VLbGU3K2JDajNjZFhOSFBvVVhNZW9RcWVpdlhKUXRuM0JVQWRtK0kza0tjTU54XG5XbVkvNTZGZ0NCWk9ob3JhdXQyWXRIdHNDdFJFNGM0K3BLOXlYTkJqTHRxRkFPY1lUNFFrMkJGUWtoMER3YzB2XG4yd2xRSEdxazJBVWU0SWV4anVQTUx0R1pyQ2JTQWdLM2c3Y01qSzBNU0svTzZjVkpnSUpRRVkrVzBjWUhidlczXG40REhObDBOVkFnTUJBQUVDZ2dFQURVYXc0dHF2eW5jaVVOYUtVRERIbjg1ZWdHL0JpbEhiellFOXdtYnRVemhVXG5oUGhaeWdOQzh3NEh2bnp3eFU5cUF2U3MyNklkQ1pjdnp0TzU5Z0dqeWNPcGZJVUt0dlN5NlpVMlhUWWlFSFo0XG5xdnRraENUNnpLODFRc3p0dUw5SkVDNFBCSkNXRElQcFZ1VnpMVUdxaWs5ekhMWHZuenhjelFBWncwRlVHZU9kXG55NUEwT1M2OWo1ZDVOdFpXTzl6eDFzOGRjKzlackliSFFGZ1NhS2NzZUFKSThodXdtdGhVbHZ6RmlKOTJDVG13XG4vMDNGZEhWRGJ5TnlmTlU4S3pRaDN0d1JFbGlkSGtlUWg5WmlDcUVmRHdSNU9PMnpidWF2VUlsUTYwQ3REVGgyXG42dUtYRy9mT3JwNVh2RjFRQ1g5bTlTRWZMQlk4ajAyeTJoOXNXNk5GQ1FLQmdRRFF1UVp0dUxMOU1ORDZTTXZpXG5DTXB5ZGhucDcxSXB1emM0dy81RkNmcjBXeDY2NGdZZlY3WjlGQkNMWmh5M1JITDlJazkwWUs2Sk9xTVp4NGlyXG54UWRvVll1Qk9ubzRISkxOaEJpa3IySVE5RlVRNFk4YzBOcHRXWEoySVJYTXVlNHlJN2lvclRBYjVPQ2JoTjJVXG5EU3UyY2pxbEk5MkRGSE5yaDNxN0x2T0hxUUtCZ1FDODBhUk5Fb09PbkQzekVEZk13ZU1EU25LcVpybkdGSlNQXG42aVMxMXB0M2FpNW1zaXZ2RDJ6bVdqLzRFV1BpNFB6RGRFajNicVByNUZqbkdxMlo4SU1YYzA1c1RvQXdhblFlXG5BeDIwRUl0WStFVVJ1MEZBME9uK0VKakJ4SzRISGZRcllSNUdvM0hmTU1KTnR2NHdhQUtubFZGSG9yQko1blU3XG5JaXdlcjhjNXpRS0JnUUNVR21Za1h3V3F3UVBZUk9WZTYwdnpzamVyRmlVZjlYYzJzV1B3U3llbVVpM1kvOTdHXG5TSy8xeXRIK2lDTmlLNURJYTVzamdpTDJ2d1BTbkJJdmlDdzhiVThERUtKK3hFK3F3c3ZWdDVrSFhNZ3JwVkd1XG5hY2hFQlU5QjRUSWR4ZVR0OFFqcnI1Qk9pcmFSdzlLU1psSVpNSzdLVlV1dDRrb1FCOThmaVM1R21RS0JnUUM4XG5VNFRDY3BMUXJMbUZNMG5VYWhYWWRHckYxc3UzNjFMNTc1bEozSkVYbThwSUY3R0dNU1oyNHRFbXhZR1JDc0pRXG4yQ3ptelcybG5BMm9BNDNmR21wRiszWGV4TFZLbFFMWDVGZTkvenBkTk5ML0NudmRBQUpDcTU4UXRQQzJuSU9xXG51S1VQNDNseUdSblRsWThXRE1lSkNuOFZLZ2tXekV0ay9ZSnY0UGFlaVFLQmdGblhOWGp3bzdoRk1BOTU0ejlIXG5FRU1YbDZxWk1GT3IvcUVvaDFBUFpUcjNQdUNNdGVjQlV0YS9WVlVESjdZODVBZFdTeTNuTnlyVWIxYlBqMVNXXG4yVW5SdXM2MFpDL3I5dzBZKytMUTdKS0VsTC9aMFNPNTltWEJZeXY3dzd0ZzQ0RHRucmZlT0sxSXdDUHU2NlJLXG5EQWlhdnFYTVlyWjJUSDBucVpvMlN1a21cbi0tLS0tRU5EIFBSSVZBVEUgS0VZLS0tLS1cbiIsCiAgImNsaWVudF9lbWFpbCI6ICJmaXJlYmFzZS1hZG1pbnNkay1mYnN2Y0BzdHVkZW50LXBvcnRhbC1lYTNhZS5pYW0uZ3NlcnZpY2VhY2NvdW50LmNvbSIsCiAgImNsaWVudF9pZCI6ICIxMDI5NDgxMDkyMTcwMDg5NTYwMzkiLAogICJhdXRoX3VyaSI6ICJodHRwczovL2FjY291bnRzLmdvb2dsZS5jb20vby9vYXV0aDIvYXV0aCIsCiAgInRva2VuX3VyaSI6ICJodHRwczovL29hdXRoMi5nb29nbGVhcGlzLmNvbS90b2tlbiIsCiAgImF1dGhfcHJvdmlkZXJfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9vYXV0aDIvdjEvY2VydHMiLAogICJjbGllbnRfeDUwOV9jZXJ0X3VybCI6ICJodHRwczovL3d3dy5nb29nbGVhcGlzLmNvbS9yb2JvdC92MS9tZXRhZGF0YS94NTA5L2ZpcmViYXNlLWFkbWluc2RrLWZic3ZjJTQwc3R1ZGVudC1wb3J0YWwtZWEzYWUuaWFtLmdzZXJ2aWNlYWNjb3VudC5jb20iLAogICJ1bml2ZXJzZV9kb21haW4iOiAiZ29vZ2xlYXBpcy5jb20iCn0K`;

if (!base64) {
  throw new Error("Firebase config not found in .env");
}

const serviceAccount = JSON.parse(
  Buffer.from(base64, 'base64').toString('utf-8')
);

// ‚úÖ Initialize Firebase Admin
admin.initializeApp({
  credential: admin.credential.cert(serviceAccount),
});

export default admin;
